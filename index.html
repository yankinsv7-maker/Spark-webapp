<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Spark Auto Check</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #0c0c0e;
            --card-bg: rgba(30, 30, 32, 0.85);
            --accent-rf: #007aff;
            --accent-cn: #ff3b30;
            --text-primary: #ffffff;
            --text-secondary: #8e8e93;
            --success: #34c759;
        }
        body {
            background-color: var(--bg-color); color: var(--text-primary);
            font-family: -apple-system, sans-serif; margin: 0; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; position: relative; overflow-x: hidden;
        }
        .bg-flag {
            position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%);
            width: 150%; height: 100%; object-fit: cover; opacity: 0;
            transition: opacity 1s ease; z-index: -1; filter: blur(60px) brightness(0.2);
        }
        .active-flag { opacity: 0.7; }
        h1 { font-size: 22px; margin: 10px 0 5px; font-weight: 900; letter-spacing: 1px; }
        .subtitle { color: var(--text-secondary); font-size: 11px; margin-bottom: 25px; text-transform: uppercase; }
        .selector { display: flex; gap: 12px; width: 100%; max-width: 380px; margin-bottom: 25px; }
        .card {
            flex: 1; background: var(--card-bg); padding: 15px; border-radius: 18px;
            text-align: center; border: 2px solid transparent; transition: 0.3s; cursor: pointer;
            backdrop-filter: blur(10px);
        }
        .card.active-rf { border-color: var(--accent-rf); box-shadow: 0 0 20px rgba(0,122,255,0.2); }
        .card.active-cn { border-color: var(--accent-cn); box-shadow: 0 0 20px rgba(255,59,48,0.2); }
        .input-group { width: 100%; max-width: 340px; margin-bottom: 15px; }
        input {
            width: 100%; padding: 18px; border-radius: 15px; border: 1px solid #333;
            background: rgba(40, 40, 42, 0.9); color: white; font-size: 18px;
            text-align: center; text-transform: uppercase; outline: none; box-sizing: border-box;
        }
        .sources-info { font-size: 10px; color: var(--text-secondary); text-align: center; margin-bottom: 20px; }
        .agreement {
            display: flex; align-items: center; gap: 10px; width: 100%; max-width: 340px;
            margin-bottom: 25px; background: rgba(255,255,255,0.05); padding: 12px; border-radius: 12px;
        }
        .agreement input { width: 20px; height: 20px; margin: 0; cursor: pointer; }
        .agreement label { font-size: 11px; color: var(--text-secondary); line-height: 1.3; }
        .price-list { width: 100%; max-width: 380px; margin-bottom: 25px; }
        .price-item {
            background: var(--card-bg); padding: 15px; border-radius: 16px;
            margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;
        }
        .price-val { color: var(--success); font-weight: 800; font-size: 17px; }
        .btn-example {
            background: none; border: 1px solid #444; color: var(--text-secondary);
            padding: 12px 25px; border-radius: 25px; font-size: 12px; cursor: pointer;
            transition: 0.3s; margin-bottom: 40px;
        }
    </style>
</head>
<body>
    <img id="flag-rf" class="bg-flag active-flag" src="https://flagcdn.com/w1280/ru.png">
    <img id="flag-cn" class="bg-flag" src="https://flagcdn.com/w1280/cn.png">

    <h1>SPARK AUTO CHECK</h1>
    <div class="subtitle">–°–µ—Ä–≤–∏—Å —á–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏</div>

    <div class="selector">
        <div id="btn-rf" class="card active-rf" onclick="setType('RF')">
            <span style="font-size: 24px;">üá∑üá∫</span><br>
            <span style="font-size: 14px; font-weight: 700;">–†–§ / –°–ù–ì</span>
        </div>
        <div id="btn-cn" class="card" onclick="setType('CN')">
            <span style="font-size: 24px;">üá®üá≥</span><br>
            <span style="font-size: 14px; font-weight: 700;">–ö–ò–¢–ê–ô</span>
        </div>
    </div>

    <div class="input-group">
        <input type="text" id="vin-input" placeholder="–í–í–ï–î–ò–¢–ï VIN">
    </div>
    
    <div id="sources-text" class="sources-info">üîç –ë–∞–∑—ã: –ì–ò–ë–î–î, –§–ù–ü, –†–°–ê, –§–°–°–ü, –¢–ê–ú–û–ñ–ù–Ø</div>

    <div class="agreement">
        <input type="checkbox" id="agree-check" checked>
        <label for="agree-check">–Ø –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω —Å <b>–ø—Ä–∞–≤–∏–ª–∞–º–∏ —Å–µ—Ä–≤–∏—Å–∞</b> –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.</label>
    </div>

    <div class="price-list">
        <div class="price-item">
            <div><b style="font-size: 14px;">–ö—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç</b><br><small style="color:#666">–£–≥–æ–Ω –∏ –∑–∞–ª–æ–≥–∏</small></div>
            <div class="price-val">199 ‚ÇΩ</div>
        </div>
        <div class="price-item">
            <div><b style="font-size: 14px;">–ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è</b><br><small style="color:#666">–î–¢–ü, –ø—Ä–æ–±–µ–≥–∏, —Ç–∞–∫—Å–∏</small></div>
            <div class="price-val">399 ‚ÇΩ</div>
        </div>
    </div>

    <button class="btn-example" onclick="openExample()">üëÅ –ü–û–°–ú–û–¢–†–ï–¢–¨ –ü–†–ò–ú–ï–† –û–¢–ß–ï–¢–ê</button>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        let currentType = 'RF';
        tg.MainButton.setText("–ó–ê–ü–£–°–¢–ò–¢–¨ –ü–†–û–í–ï–†–ö–£").show().enable();

        function setType(type) {
            currentType = type;
            const isRF = type === 'RF';
            document.getElementById('btn-rf').className = isRF ? 'card active-rf' : 'card';
            document.getElementById('btn-cn').className = !isRF ? 'card active-cn' : 'card';
            document.getElementById('flag-rf').className = isRF ? 'bg-flag active-flag' : 'bg-flag';
            document.getElementById('flag-cn').className = !isRF ? 'bg-flag active-flag' : 'bg-flag';
            document.getElementById('sources-text').innerText = isRF ? "üîç –ë–∞–∑—ã: –ì–ò–ë–î–î, –§–ù–ü, –†–°–ê, –§–°–°–ü, –¢–ê–ú–û–ñ–ù–Ø" : "üîç –ë–∞–∑—ã: EXPORT DB, CTR, –ö–ù–†";
        }

        function openExample() {
            tg.showPopup({ title: '–ü—Ä–∏–º–µ—Ä –æ—Ç—á–µ—Ç–∞', message: '–í—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–±–µ–≥–∞—Ö, –î–¢–ü –∏ –∑–∞–ª–æ–≥–∞—Ö.', buttons: [{text: '–û–ö', type: 'ok'}] });
        }

        tg.MainButton.onClick(function() {
            const vin = document.getElementById('vin-input').value;
            const agreed = document.getElementById('agree-check').checked;
            if (!agreed) return tg.showAlert("–ü—Ä–∏–º–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞!");
            if (vin.length < 5) return tg.showAlert("–í–≤–µ–¥–∏—Ç–µ VIN!");

            tg.MainButton.showProgress();
            
            // –¢–í–û–Ø –°–°–´–õ–ö–ê –£–ñ–ï –ó–î–ï–°–¨
            const webHookUrl = "https://hook.eu1.make.com/deve7mhscs6nxy86x4dbxknph4e3jp4z";

            fetch(webHookUrl, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ vin: vin, type: currentType, user: tg.initDataUnsafe.user })
            }).then(() => { tg.close(); });
        });
    </script>
</body>
</html>

